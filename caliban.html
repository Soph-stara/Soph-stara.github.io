<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caliban's Daughters: A Game of Female Power</title>
    <style>
        :root {
            --dark-purple: #2d1b36;
            --light-purple: #9b59b6;
            --gold: #e6c068;
            --cream: #f7f1e3;
            --dark-red: #8b0000;
        }

        body {
            font-family: 'Garamond', serif;
            background-color: var(--dark-purple);
            color: var(--cream);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23483248' fill-opacity='0.2' fill-rule='evenodd'/%3E%3C/svg%3E");
        }

        .game-container {
            width: 100%;
            max-width: 800px;
            text-align: center;
        }

        h1 {
            color: var(--gold);
            margin-bottom: 10px;
            font-size: 2.5rem;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }

        h2 {
            color: var(--light-purple);
            margin-top: 0;
            font-size: 1.5rem;
            font-style: italic;
            margin-bottom: 30px;
        }

        .intro-screen {
            max-width: 600px;
            margin: 0 auto;
            background-color: rgba(45, 27, 54, 0.7);
            padding: 30px;
            border-radius: 15px;
            border: 1px solid var(--gold);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }

        .role-select {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .role-card {
            background-color: rgba(155, 89, 182, 0.3);
            border: 1px solid var(--gold);
            border-radius: 10px;
            padding: 15px;
            width: 150px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .role-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            background-color: rgba(155, 89, 182, 0.5);
        }

        .role-card h3 {
            color: var(--gold);
            margin-top: 0;
        }

        .role-card p {
            font-size: 0.9rem;
        }

        .status-bar {
            width: 100%;
            height: 30px;
            background-color: rgba(155, 89, 182, 0.3);
            border-radius: 15px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .suspicion-level {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, var(--gold), var(--light-purple), var(--dark-red));
            border-radius: 15px;
            transition: width 0.8s;
        }

        .status-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--cream);
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
        }

        .card-area {
            height: 350px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            perspective: 1000px;
        }

        .card {
            width: 220px;
            height: 330px;
            background-color: var(--cream);
            color: var(--dark-purple);
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s;
            cursor: pointer;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-back, .card-front {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 15px;
            box-sizing: border-box;
        }

        .card-back {
            background: linear-gradient(135deg, var(--dark-purple), var(--light-purple));
            color: var(--gold);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            border: 5px solid var(--gold);
        }

        .card-back:after {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            border: 2px solid rgba(230, 192, 104, 0.5);
            border-radius: 10px;
        }

        .card-front {
            transform: rotateY(180deg);
            background-color: var(--cream);
            border: 5px solid var(--gold);
        }

        .card-title {
            text-align: center;
            font-weight: bold;
            color: var(--dark-purple);
            font-size: 1.3rem;
            margin-top: 10px;
        }

        .card-content {
            text-align: center;
            padding: 10px;
            font-size: 1rem;
        }

        .card-image {
            height: 120px;
            background-color: rgba(45, 27, 54, 0.1);
            margin: 10px auto;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .choices {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 20px;
        }

        .choice-button {
            flex: 1;
            padding: 10px;
            background-color: var(--light-purple);
            color: var(--cream);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-family: 'Garamond', serif;
            font-size: 1rem;
        }

        .choice-button:hover {
            background-color: var(--dark-purple);
        }

        .draw-button {
            padding: 12px 25px;
            background-color: var(--gold);
            color: var(--dark-purple);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 10px;
            font-family: 'Garamond', serif;
        }

        .draw-button:hover {
            background-color: var(--cream);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .stats {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .game-message {
            margin-top: 20px;
            min-height: 60px;
            font-style: italic;
        }

        .hidden {
            display: none;
        }

        .game-end-screen {
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
            padding: 30px;
            background-color: rgba(45, 27, 54, 0.8);
            border-radius: 15px;
            border: 1px solid var(--gold);
        }

        .game-end-screen h2 {
            color: var(--gold);
            font-size: 2rem;
            margin-top: 0;
        }

        .restart-button {
            padding: 12px 25px;
            background-color: var(--gold);
            color: var(--dark-purple);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 20px;
            font-family: 'Garamond', serif;
        }

        .restart-button:hover {
            background-color: var(--cream);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .deck-counter {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: rgba(45, 27, 54, 0.7);
            color: var(--gold);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .allies-counter {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 1.1rem;
        }

        .allies-counter span {
            color: var(--gold);
            font-weight: bold;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 1.8rem;
            }

            h2 {
                font-size: 1.2rem;
            }

            .card {
                width: 180px;
                height: 270px;
            }

            .card-title {
                font-size: 1.1rem;
            }

            .card-content {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Intro Screen -->
        <div id="intro-screen" class="intro-screen">
            <h1>Caliban's Daughters</h1>
            <h2>A Game of Female Power</h2>
            <p>You are a woman in the Middle Ages. Your wisdom and knowledge makes you suspicious. Survive the time of witch hunts.</p>
            <p>Choose your role to begin:</p>
            <div class="role-select">
                <div class="role-card" data-role="healer">
                    <h3>Healer</h3>
                    <p>You know remedies for many ailments, but your herbal knowledge has drawn suspicion.</p>
                </div>
                <div class="role-card" data-role="midwife">
                    <h3>Midwife</h3>
                    <p>You bring new life into the world, but your knowledge of women's bodies makes some uneasy.</p>
                </div>
                <div class="role-card" data-role="wisdomkeeper">
                    <h3>Wise Woman</h3>
                    <p>Your wisdom and knowledge of old ways makes you both respected and feared.</p>
                </div>
                <div class="role-card" data-role="dissenter">
                    <h3>Dissenter</h3>
                    <p>You speak out against injustice, challenging the emerging patriarchal order.</p>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="hidden">
            <h1>Caliban's Daughters</h1>
            <div class="stats">
                <div class="allies-counter">Allies: <span id="allies-count">0</span></div>
                <div class="rounds-counter">Round: <span id="round-count">1</span>/10</div>
            </div>
            <div class="status-bar">
                <div class="suspicion-level" id="suspicion-bar"></div>
                <div class="status-label">Suspicion: <span id="suspicion-value">30</span>%</div>
            </div>
            <div class="card-area">
                <div class="card" id="current-card">
                    <div class="card-back">
                        Caliban's<br>Daughters
                    </div>
                    <div class="card-front">
                        <div class="card-title" id="card-title"></div>
                        <div class="card-image" id="card-image">
                            <!-- Card symbol will go here -->
                        </div>
                        <div class="card-content" id="card-content"></div>
                        <div class="deck-counter" id="deck-counter"></div>
                    </div>
                </div>
            </div>
            <div class="choices hidden" id="choices">
                <button class="choice-button" id="upright-choice"></button>
                <button class="choice-button" id="reversed-choice"></button>
            </div>
            <button class="draw-button" id="draw-button">Draw a Card</button>
            <div class="game-message" id="game-message"></div>
        </div>

        <!-- End Screen -->
        <div id="end-screen" class="game-end-screen hidden">
            <h2 id="end-title"></h2>
            <p id="end-message"></p>
            <button class="restart-button" id="restart-button">Play Again</button>
        </div>
    </div>

    <script>
        // Game data
        const cards = [
            {
                title: "The Moon",
                content: "Rumor has it that you are a witch. The whispers spread through the village.",
                upright: {
                    text: "Hide in the forest",
                    effect: { suspicion: -10, message: "The forest shelters you. The rumors die down... for now." }
                },
                reversed: {
                    text: "Ignore the rumors",
                    effect: { suspicion: +20, message: "The whispers grow louder as your indifference is seen as defiance." }
                }
            },
            {
                title: "The Tower",
                content: "The inquisitor arrives in a nearby town. Panic spreads throughout the region.",
                upright: {
                    text: "Join resistance movement",
                    effect: { suspicion: +10, allies: +1, message: "You find others who oppose the witch hunts. Risky, but you are not alone." }
                },
                reversed: {
                    text: "Blend in with villagers",
                    effect: { suspicion: -5, message: "You hide your knowledge and practices, keeping to yourself." }
                }
            },
            {
                title: "The High Priestess",
                content: "Your healing knowledge has saved a child from illness. The village takes notice.",
                upright: {
                    text: "Share your knowledge",
                    effect: { allies: +1, message: "You teach others your remedies. Some appreciate your wisdom." }
                },
                reversed: {
                    text: "Take credit for the healing",
                    effect: { suspicion: +15, message: "Your abilities are seen as unnatural by some in the village." }
                }
            },
            {
                title: "The Hermit",
                content: "A woman from a neighboring village seeks your help, fleeing persecution.",
                upright: {
                    text: "Help her escape",
                    effect: { suspicion: +5, allies: +1, message: "You risk your safety to aid another. She will remember your kindness." }
                },
                reversed: {
                    text: "Turn her away",
                    effect: { suspicion: -5, message: "You protect yourself, but lose a potential ally." }
                }
            },
            {
                title: "Death",
                content: "A woman in the village has been accused of witchcraft and awaits trial.",
                upright: {
                    text: "Speak in her defense",
                    effect: { suspicion: +20, allies: +1, message: "Your words cast suspicion on you, but you've shown great courage." }
                },
                reversed: {
                    text: "Stay silent",
                    effect: { suspicion: -5, message: "You preserve your safety, but the guilt weighs on you." }
                }
            },
            {
                title: "The Devil",
                content: "The local priest warns about women who defy natural order and church teachings.",
                upright: {
                    text: "Question his teachings secretly",
                    effect: { allies: +1, message: "Others share your doubts. You form a quiet network of dissenters." }
                },
                reversed: {
                    text: "Attend church dutifully",
                    effect: { suspicion: -10, message: "Your public piety provides some protection." }
                }
            },
            {
                title: "The Empress",
                content: "Your knowledge of reproductive medicine could help a suffering noblewoman.",
                upright: {
                    text: "Offer your services",
                    effect: { suspicion: -15, message: "The noblewoman recovers and becomes your protector." }
                },
                reversed: {
                    text: "Keep your knowledge hidden",
                    effect: { suspicion: -5, message: "You remain safe but unseen." }
                }
            },
            {
                title: "The Magician",
                content: "You discover an ancient text with forbidden knowledge.",
                upright: {
                    text: "Study it in secret",
                    effect: { allies: +1, message: "The knowledge connects you to an underground network of learned women." }
                },
                reversed: {
                    text: "Destroy the text",
                    effect: { suspicion: -10, message: "You eliminate evidence that could condemn you." }
                }
            },
            {
                title: "The Star",
                content: "A midnight gathering of women is planned to share knowledge and resources.",
                upright: {
                    text: "Attend the gathering",
                    effect: { suspicion: +5, allies: +2, message: "The risk was worth it. You've found your community." }
                },
                reversed: {
                    text: "Stay home",
                    effect: { suspicion: -5, message: "Better safe than sorry, though opportunity is lost." }
                }
            },
            {
                title: "Justice",
                content: "You are directly accused of witchcraft by a neighbor who envies your independence.",
                upright: {
                    text: "Flee the village",
                    effect: { suspicion: -10, message: "You abandon your home but preserve your freedom." }
                },
                reversed: {
                    text: "Stand your ground",
                    effect: { suspicion: +25, message: "Your defiance is noted by authorities. The situation grows dire." }
                }
            }
        ];

        // Role effect modifiers
        const roleEffects = {
            healer: { suspicionStart: 20, specialEffect: "healing" },
            midwife: { suspicionStart: 25, specialEffect: "respected" },
            wisdomkeeper: { suspicionStart: 35, specialEffect: "knowledge" },
            dissenter: { suspicionStart: 40, specialEffect: "rebellion" }
        };

        // Game state
        let gameState = {
            suspicion: 0,
            allies: 0,
            deck: [],
            currentRole: "",
            specialEffect: "",
            round: 1,
            maxRounds: 10
        };

        // DOM elements
        const introScreen = document.getElementById('intro-screen');
        const gameScreen = document.getElementById('game-screen');
        const endScreen = document.getElementById('end-screen');
        const roleCards = document.querySelectorAll('.role-card');
        const suspicionBar = document.getElementById('suspicion-bar');
        const suspicionValue = document.getElementById('suspicion-value');
        const currentCard = document.getElementById('current-card');
        const cardTitle = document.getElementById('card-title');
        const cardImage = document.getElementById('card-image');
        const cardContent = document.getElementById('card-content');
        const choices = document.getElementById('choices');
        const uprightChoice = document.getElementById('upright-choice');
        const reversedChoice = document.getElementById('reversed-choice');
        const drawButton = document.getElementById('draw-button');
        const gameMessage = document.getElementById('game-message');
        const deckCounter = document.getElementById('deck-counter');
        const alliesCount = document.getElementById('allies-count');
        const roundCount = document.getElementById('round-count');
        const endTitle = document.getElementById('end-title');
        const endMessage = document.getElementById('end-message');
        const restartButton = document.getElementById('restart-button');

        // Initialize the game
        function initGame() {
            // Reset game state
            gameState.deck = [...cards];
            shuffleDeck();
            
            // Set up event listeners
            roleCards.forEach(card => {
                card.addEventListener('click', selectRole);
            });
            
            drawButton.addEventListener('click', drawCard);
            uprightChoice.addEventListener('click', () => makeChoice('upright'));
            reversedChoice.addEventListener('click', () => makeChoice('reversed'));
            restartButton.addEventListener('click', restartGame);
            
            updateDeckCounter();
        }

        // Shuffle the deck
        function shuffleDeck() {
            for (let i = gameState.deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [gameState.deck[i], gameState.deck[j]] = [gameState.deck[j], gameState.deck[i]];
            }
        }

        // Select role and start game
        function selectRole() {
            const role = this.getAttribute('data-role');
            gameState.currentRole = role;
            gameState.suspicion = roleEffects[role].suspicionStart;
            gameState.specialEffect = roleEffects[role].specialEffect;
            
            introScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            updateSuspicionBar();
            updateStats();
            
            gameMessage.textContent = `You begin your journey as a ${role}. Your knowledge makes you both valuable and vulnerable.`;
        }

        // Draw a card
        function drawCard() {
            if (gameState.deck.length === 0) {
                endGame('defeat', 'The witch hunts have intensified. You have run out of options.');
                return;
            }
            
            // Draw a card from the deck
            const card = gameState.deck.pop();
            
            // Display the card
            cardTitle.textContent = card.title;
            cardContent.textContent = card.content;
            
            // Set card symbol (simplified for this version)
            cardImage.innerHTML = `<svg width="100" height="100" viewBox="0 0 100 100">
                <text x="50" y="55" font-size="24" text-anchor="middle" fill="#2d1b36">${card.title}</text>
            </svg>`;
            
            // Flip the card
            currentCard.classList.add('flipped');
            
            // Show choices after a delay
            setTimeout(() => {
                choices.classList.remove('hidden');
                drawButton.classList.add('hidden');
                
                // Set choice texts
                uprightChoice.textContent = card.upright.text;
                reversedChoice.textContent = card.reversed.text;
                
                // Store current card for choice handling
                gameState.currentCard = card;
            }, 1000);
            
            updateDeckCounter();
        }

        // Make a choice
        function makeChoice(type) {
            const card = gameState.currentCard;
            const effect = card[type].effect;
            
            // Apply effects
            if (effect.suspicion) {
                gameState.suspicion += effect.suspicion;
                // Ensure suspicion stays within 0-100 range
                gameState.suspicion = Math.max(0, Math.min(100, gameState.suspicion));
            }
            
            if (effect.allies) {
                gameState.allies += effect.allies;
            }
            
            // Update UI
            updateSuspicionBar();
            updateStats();
            
            // Display message
            gameMessage.textContent = effect.message;
            
            // Hide choices
            choices.classList.add('hidden');
            
            // Unflip card
            setTimeout(() => {
                currentCard.classList.remove('flipped');
            }, 1000);
            
            // Show draw button after delay
            setTimeout(() => {
                // Check win/lose conditions
                if (gameState.suspicion >= 100) {
                    endGame('defeat', 'You have been accused of witchcraft and face trial. Your story ends here.');
                    return;
                }
                
                if (gameState.allies >= 5) {
                    endGame('victory', 'You have built a strong network of allies. Together, you create an underground community of resistance and support.');
                    return;
                }
                
                gameState.round++;
                updateStats();
                
                if (gameState.round > gameState.maxRounds) {
                    if (gameState.suspicion < 30) {
                        endGame('victory', 'You have successfully navigated the witch hunt period. Your knowledge lives on.');
                    } else if (gameState.suspicion < 70) {
                        endGame('survival', 'You survive, but must continue to be cautious. The threat never truly ends.');
                    } else {
                        endGame('defeat', 'The suspicion around you has grown too great. You must flee or face certain doom.');
                    }
                    return;
                }
                
                drawButton.classList.remove('hidden');
            }, 2000);
        }

        // Update suspicion bar
        function updateSuspicionBar() {
            suspicionBar.style.width = `${gameState.suspicion}%`;
            suspicionValue.textContent = gameState.suspicion;
        }

        // Update stats
        function updateStats() {
            alliesCount.textContent = gameState.allies;
            roundCount.textContent = `${gameState.round}/${gameState.maxRounds}`;
        }

        // Update deck counter
        function updateDeckCounter() {
            deckCounter.textContent = `${gameState.deck.length} cards left`;
        }

        // End game
        function endGame(result, message) {
            gameScreen.classList.add('hidden');
            endScreen.classList.remove('hidden');
            
            if (result === 'victory') {
                endTitle.textContent = 'Victory!';
                endTitle.style.color = '#e6c068';
            } else if (result === 'survival') {
                endTitle.textContent = 'You Survived';
                endTitle.style.color = '#9b59b6';
            } else if (result === 'defeat') {
                endTitle.textContent = 'Defeat';
                endTitle.style.color = '#8b0000';
            }
            
            endMessage.textContent = message;
        }

        // Restart game
        function restartGame() {
            // Reset game state
            gameState = {
                suspicion: 0,
                allies: 0,
                deck: [],
                currentRole: "",
                specialEffect: "",
                round: 1,
                maxRounds: 10
            };
            
            // Reset UI
            currentCard.classList.remove('flipped');
            choices.classList.add('hidden');
            drawButton.classList.remove('hidden');
            gameMessage.textContent = '';
            
            // Show intro screen
            endScreen.classList.add('hidden');
            gameScreen.classList.add('hidden');
            introScreen.classList.remove('hidden');
            
            // Reinitialize game
            initGame();
        }

        // Start the game
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>